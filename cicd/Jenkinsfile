node {
    stage("1. Checkout "){
        checkout scm
    }
    stage("2.Dotnet Build"){
        sh"""
        java -version
        cd samples/aspnetapp/aspnetapp
        /usr/local/share/dotnet/dotnet restore
        /usr/local/share/dotnet/dotnet publish -c Release -o ./publish
        echo HelloWorld
        """
    }
    stage("3.Build Image"){
        app = docker.build("vietanh271098/dotnet:test", "-f ../samples/aspnetapp/Dockerfile .")
    }
    stage("4.Push Image"){
        docker.withRegistry("https://", 'credential-docker'){
            app.push()
        }
    }
}